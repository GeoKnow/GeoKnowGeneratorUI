@prefix :        <http://ldiw.ontos.com/acc/resource/> .
@prefix d2rq:    <http://www.wiwiss.fu-berlin.de/suhl/bizer/D2RQ/0.1#> .
@prefix dcmit:   <http://purl.org/dc/dcmitype/> .
@prefix dcterms:  <http://purl.org/dc/terms/> .
@prefix lds:     <http://stack.linkeddata.org/ldis-schema/> .
@prefix owl:     <http://www.w3.org/2002/07/owl#> .
@prefix rdf:     <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs:    <http://www.w3.org/2000/01/rdf-schema#> .
@prefix schema:  <http://schema.org/> .
@prefix sd:      <http://www.w3.org/ns/sparql-service-description#> .
@prefix void:    <http://rdfs.org/ns/void#> .
@prefix xsd:     <http://www.w3.org/2001/XMLSchema#> .
@prefix foaf:    <http://xmlns.com/foaf/0.1/> .
@prefix gkg:     <http://ldiw.ontos.com/acc/ontology/> .
@prefix acl:     <http://www.w3.org/ns/auth/acl#> .

########### ABOUT THIS FILE #############################################################
# This file contains the default set-up of components in the framework; 
# this file is to be loaded initially on the settigns Graph of the default user, 
# and for each new user.
# NOTE: avoid using blank nodes may cause problems loading the file:
#    - https://www.mail-archive.com/virtuoso-users@lists.sourceforge.net/msg05138.html
# #######################################################################################

:GeoKnowGeneratorService a sd:Service;
    sd:endpoint <http://144.76.166.111:8890/sparql>;
    sd:supportedLanguage sd:SPARQL11Query ;
    sd:defaultDataset :default-dataset;
    .

:default-dataset a sd:Dataset;
    rdfs:label "GeoKnow Generator";
    dcterms:description "The GeoKnow Generator Service"^^xsd:string;
    sd:defaultGraph <http://144.76.166.111:8890/DAV>;
    sd:namedGraph :settingsGraph;
    .
<http://144.76.166.111:8890/DAV> a sd:Graph, void:Dataset;
    rdfs:label "Default Graph";
    dcterms:description "Default graph"^^xsd:string;
    .

########### COMPONENT DESCRIPTION #######################################################
# Following triples  describes the configured components in the framework
# #######################################################################################

:GeoKnowGenerator
  a       lds:StackComponent ;
  rdfs:comment "This resource contains all the configuration required by the application"^^xsd:string ;
  rdfs:label "GeoKnowGeneator"^^xsd:string ;
  dcterms:hasVersion "2.0"^^xsd:string ;
  gkg:publicEndpoint :VirtuosoEndpoint ;
  gkg:authEndpoint :VirtuosoAuthSPARQLEndpoint ;
  lds:integrates :Facete, :Limes, :Sparqlify, :TripleGeo, :GeoLift, :OntoWiki, :Mappify ;
  foaf:homepage <http://144.76.166.111:8080/ontos-ldiw-generator> .

:D2RQ
      a       lds:StackComponent ;
      rdfs:label "D2RQ"^^xsd:string ;
      lds:providesService :D2RQService ;
      lds:version "0.1-SNAPSHOT"^^xsd:string .
:D2RQService
      a       lds:ExtractionService ;
      dcterms:description "Provides ontology create/upload/delete functionality"^^xsd:string ;
      lds:serviceUrl <http://acc.ontos.com/d2rq/api> .

:MiniDix
      a       lds:StackComponent ;
      rdfs:label "MiniDix"^^xsd:string ;
      lds:providesService :MiniDixService ;
      lds:version "0.1-SNAPSHOT"^^xsd:string .
:MiniDixService
      a       lds:AuthoringService ;
      dcterms:description "Provides thesaurus edit functionality"^^xsd:string ;
      lds:serviceUrl <http://acc.ontos.com/minidix> .

:Solr
      a       lds:StackComponent ;
      rdfs:label "Solr"^^xsd:string ;
      lds:providesService :SearchService ;
      lds:version "4.8.1"^^xsd:string .
:SearchService
      a       lds:ExplorationService ;
      dcterms:description "Provides Solr Search."^^xsd:string ;
      lds:serviceUrl <http://acc.ontos.com/search> .

:DocumentComponent
      a       lds:StackComponent ;
      rdfs:label "Documents Manager"^^xsd:string ;
      lds:providesService :DocumentUploadService ;
      lds:providesService :DocumentService ;
      lds:providesService :ReindexService ;
      lds:version "0.1-SNAPSHOT"^^xsd:string .
:DocumentUploadService
      a       lds:ExtractionService ;
      dcterms:description "Provides document upload functionality"^^xsd:string ;
      lds:serviceUrl <http://acc.ontos.com/SolrUploadProxy/proxy/upload/files> .
:DocumentService
      a       lds:AuthoringService ;
      dcterms:description "Provides documents view/edit functionality."^^xsd:string ;
      lds:serviceUrl <http://acc.ontos.com/SolrUploadProxy/proxy> .
:ReindexService
      a       lds:ExtractionService ;
      dcterms:description "Reindex all documents with current thesaurus."^^xsd:string ;
      lds:serviceUrl <http://acc.ontos.com/SolrUploadProxy/proxy/update/reindexWithNewThesaurus> .

:UserManager
      a       lds:StackComponent ;
      rdfs:label "Users Manager"^^xsd:string ;
      lds:providesService :UserManagerService ;
      lds:version "0.1-SNAPSHOT"^^xsd:string .
:UserManagerService
      a       lds:ComponentService ;
      dcterms:description "Provides create/update functionality for accounts and roles."^^xsd:string ;
      lds:serviceUrl <http://144.76.166.111:8080/ontos-ldiw-generator/UserManagerServlet> .

########### ROUTES RESTRICTIONS DESCRIPTION #######################################################
# Following triples describe required services for routes. It is used in conditional routing.
# #######################################################################################

:UploadFileRouteRestriction
      a     gkg:RouteRestriction;
      gkg:partialUrl "/home/extraction-and-loading/upload-file"^^xsd:string;
      gkg:requiredService :DocumentUploadService .

:EditUploadsRouteRestriction
      a     gkg:RouteRestriction;
      gkg:partialUrl "/home/manual-revision-and-authoring/edit-uploads"^^xsd:string;
      gkg:requiredService :DocumentService .

:OntologyRouteRestriction
      a     gkg:RouteRestriction;
      gkg:partialUrl "/settings/ontology"^^xsd:string;
      gkg:requiredService :D2RQService;
      gkg:requiredService :MiniDixService .

:RolesRouteRestriction
      a     gkg:RouteRestriction;
      gkg:partialUrl "/settings/roles"^^xsd:string;
      gkg:requiredService :UserManagerService .